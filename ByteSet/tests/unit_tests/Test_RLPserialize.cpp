#include <gtest/gtest.h>
#include <ByteSet/ByteSet.h>

TEST(Test_RLPSerialize, empty)
{
    ByteSet<BIT> b1, r1;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, false);
    ASSERT_EQ(r1, ByteSet<BIT>(0x80, 8));
    b1.clear();
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, true);
    ASSERT_EQ(r1, ByteSet<BIT>(0xC0, 8));

    ByteSet<NIBBLE> b4, r4;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, false);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0x80, 2));
    b4.clear();
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, true);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0xC0, 2));

    ByteSet<BYTE> b8, r8;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, false);
    ASSERT_EQ(r8, ByteSet<BYTE>(0x80, 1));
    b8.clear();
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, true);
    ASSERT_EQ(r8, ByteSet<BYTE>(0xC0, 1));
}

TEST(Test_RLPSerialize, zero)
{
    ByteSet<BIT> b1(0), r1;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, false);
    ASSERT_EQ(r1, ByteSet<BIT>(0x00, 8));
    b1 = 0;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, true);
    ASSERT_EQ(r1, ByteSet<BIT>(0xC100, 16));

    ByteSet<NIBBLE> b4(0), r4;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, false);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0x00, 2));
    b4 = 0;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, true);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0xC100, 4));

    ByteSet<BYTE> b8(0), r8;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, false);
    ASSERT_EQ(r8, ByteSet<BYTE>(0x00, 1));
    b8 = 0;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, true);
    ASSERT_EQ(r8, ByteSet<BYTE>(0xC100, 2));
}

TEST(Test_RLPSerialize, own_rlp)
{
    //----------- LOW BOUNDARY -------------

    ByteSet<BIT> b1(1), r1;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, false);
    ASSERT_EQ(r1, ByteSet<BIT>(0x01, 8));
    b1 = 1;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, true);
    ASSERT_EQ(r1, ByteSet<BIT>(0xC101, 16));

    ByteSet<NIBBLE> b4(1), r4;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, false);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0x01, 2));
    b4 = 1;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, true);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0xC101, 4));

    ByteSet<BYTE> b8(1), r8;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, false);
    ASSERT_EQ(r8, ByteSet<BYTE>(0x01, 1));
    b8 = 1;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, true);
    ASSERT_EQ(r8, ByteSet<BYTE>(0xC101, 2));

    //----------- HIGH BOUNDARY -------------

    b1 = 0x7F;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, false);
    ASSERT_EQ(r1, ByteSet<BIT>(0x7F, 8));
    b1 = 0x7F;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, true);
    ASSERT_EQ(r1, ByteSet<BIT>(0xC17F, 16));

    b4 = 0x7F;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, false);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0x7F, 2));
    b4 = 0x7F;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, true);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0xC17F, 4));

    b8 = 0x7F;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, false);
    ASSERT_EQ(r8, ByteSet<BYTE>(0x7F, 1));
    b8 = 0x7F;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, true);
    ASSERT_EQ(r8, ByteSet<BYTE>(0xC17F, 2));
}

TEST(Test_RLPSerialize, x80_xC0_rlp)
{
    //----------- LOW BOUNDARY -------------

    ByteSet<BIT> b1(0x80), r1;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, false);
    ASSERT_EQ(r1, ByteSet<BIT>(0x8180, 16));
    b1 = 0x80;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, true);
    ASSERT_EQ(r1, ByteSet<BIT>(0xC180, 16));

    ByteSet<NIBBLE> b4(0x80), r4;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, false);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0x8180, 4));
    b4 = 0x80;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, true);
    ASSERT_EQ(r4, ByteSet<NIBBLE>(0xC180, 4));

    ByteSet<BYTE> b8(0x80), r8;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, false);
    ASSERT_EQ(r8, ByteSet<BYTE>(0x8180, 2));
    b8 = 0x80;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, true);
    ASSERT_EQ(r8, ByteSet<BYTE>(0xC180, 2));
    
    //----------- HIGH BOUNDARY -------------
    
    b1 = ByteSet<BIT>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, false);
    ASSERT_EQ(r1, ByteSet<BIT>("0xB7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b1 = ByteSet<BIT>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, true);
    ASSERT_EQ(r1, ByteSet<BIT>("0xF7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b4 = ByteSet<NIBBLE>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, false);
    ASSERT_EQ(r4, ByteSet<NIBBLE>("0xB7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b4 = ByteSet<NIBBLE>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, true);
    ASSERT_EQ(r4, ByteSet<NIBBLE>("0xF7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b8 = ByteSet<BYTE>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, false);
    ASSERT_EQ(r8, ByteSet<BYTE>("0xB7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b8 = ByteSet<BYTE>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, true);
    ASSERT_EQ(r8, ByteSet<BYTE>("0xF7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

}

TEST(Test_RLPSerialize, xB7_xF7_rlp)
{
    //----------- LOW BOUNDARY -------------
    
    ByteSet<BIT> b1("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex), r1;
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, false);
    ASSERT_EQ(r1, ByteSet<BIT>("0xB8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b1 = ByteSet<BIT>("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, true);
    ASSERT_EQ(r1, ByteSet<BIT>("0xF8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));


    ByteSet<NIBBLE> b4("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex), r4;
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, false);
    ASSERT_EQ(r4, ByteSet<NIBBLE>("0xB8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b4 = ByteSet<NIBBLE>("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, true);
    ASSERT_EQ(r4, ByteSet<NIBBLE>("0xF8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));

    ByteSet<BYTE> b8("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex), r8;
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, false);
    ASSERT_EQ(r8, ByteSet<BYTE>("0xB8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));
    b8 = ByteSet<BYTE>("0x0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex);
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, true);
    ASSERT_EQ(r8, ByteSet<BYTE>("0xF8380100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000", Hex));


    //----------- HIGHER BOUNDARY (2 Bytes size_size) -------------

    b1 = ByteSet<BIT>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, false);
    ASSERT_EQ(r1, ByteSet<BIT>("0xB90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b1 = ByteSet<BIT>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r1 = RLPByteSet<BIT>::RLPSerialize(b1, true);
    ASSERT_EQ(r1, ByteSet<BIT>("0xF90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b4 = ByteSet<NIBBLE>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, false);
    ASSERT_EQ(r4, ByteSet<NIBBLE>("0xB90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b4 = ByteSet<NIBBLE>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r4 = RLPByteSet<NIBBLE>::RLPSerialize(b4, true);
    ASSERT_EQ(r4, ByteSet<NIBBLE>("0xF90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

    b8 = ByteSet<BYTE>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, false);
    ASSERT_EQ(r8, ByteSet<BYTE>("0xB90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));
    b8 = ByteSet<BYTE>("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex);
    r8 = RLPByteSet<BYTE>::RLPSerialize(b8, true);
    ASSERT_EQ(r8, ByteSet<BYTE>("0xF90100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", Hex));

}